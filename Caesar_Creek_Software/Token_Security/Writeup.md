This challenge stumped me for a while because I thought it was going to be a simple padding oracle attack because the encryption system is cbc encryption but it turned out to be more confusing. My first instinct in this challenge was to look at the code and see what encryption algorithm it uses. I noticed it was cbc and instantly started thinking what attacks are possible. With previous challenges I have completed I knew padding oracle was a good chance but the issue is this challenge does not tell you any information about padding errors which makes a padding oracle attack impossible. This made me think for a really long time about how I would create a successful bit flipping attack that would give me a valid json string. I first started by finding a input that would create a 2 block string with a third block as \x10 pcks7 padding this made it very easy to modify the first and second blocks and I had a easy third block hat would get chopped off during the unpadding process. The next step was trying the bit flip attack to modify the value "users" to the value "admin" this was a struggle at first because I was stumped on how I manage to keep the user value valid while also changing the role value to "admin". After giving it a lot of thought i decided to look it up on if i even need a value of the user or if it would default to null or some empty string and it turns out when the json.Unmarshal() function runs it will default any values like a string to "". This is important because the user I am logged in as does not really matter it is just if I am admin or not. I decided to try this and remove the original IV. This would allow me to remove the decryption of the first block so I no longer got the giberish from before instead I could modify the second block to be '{"role":"admin"}' with my third block being the padding so I would not get a padding error and I got the flag.
